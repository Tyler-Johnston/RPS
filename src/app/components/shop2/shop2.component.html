<div class="shop-container">
    <h2>Shop</h2>
    <p class="points">Points: {{ gameData.points }}</p>

    <div class="container">
        <p *ngIf="gameData.scissorBranchChosen != 'none'">Rocks: {{ gameData.rocks }}</p>
        <p *ngIf="gameData.rockBranchChosen != 'none'">Papers: {{ gameData.papers }}</p>
        <p *ngIf="gameData.paperBranchChosen != 'none'">Scissors: {{ gameData.scissors }}</p>
    </div>

    <div class="container">
        <!-- Rock Generator -->
        <div class="shop-item">
            <p>Rock Generator</p>
            <p>Generates {{ gameData.rockGenerationAmount }} rock{{ gameData.rockGenerationAmount == 1 ? '' : 's' }} every {{ gameData.rockGeneratorInterval }} seconds</p>
          
            <!-- Not Purchased -->
            <ng-container *ngIf="!gameData.rockGeneratorActive">
              <p>Cost: {{ gameData.generatorCost }} points</p>
              <button 
                  (click)="purchaseGenerator('rock')" 
                  [disabled]="(gameData.points < gameData.generatorCost) || (!gameData.rockSniperActive)">
                  Buy
              </button>
            </ng-container>
          
            <!-- Active and Not Maxed -->
            <ng-container *ngIf="gameData.rockGeneratorActive && gameData.rockGenerationAmount < gameData.maxGenerationAmount">
              <p>{{ gameData.rockGenerationAmount }} → 
                {{ gameData.rockGenerationAmount + (gameData.firstRockGenUpgrade ? gameData.generationIncrement - 1 : gameData.generationIncrement) }}
              </p>
              <p>Cost: {{ gameData.rockGenerationUpgradeCost }} points</p>
              <button 
                  (click)="purchaseGenerationUpgrade('rock')"
                  [disabled]="(gameData.points < gameData.rockGenerationUpgradeCost)">
                  Upgrade
              </button>
            </ng-container>
          
            <!-- Maxed and No Branch Picked -->
            <ng-container *ngIf="gameData.rockGeneratorActive && gameData.rockGenerationAmount >= gameData.maxGenerationAmount && (gameData.rockBranchChosen === 'none')">
              <p>Generator Maxed. Choose your upgrade path:</p>
              <button (click)="chooseBranch('rock', 'interval')">Improve Generation Speed</button>
              <button (click)="chooseBranch('rock', 'active')">Collect Active Falling Rocks</button>
            </ng-container>
          
            <!-- Branch: Interval -->
            <ng-container *ngIf="gameData.rockBranchChosen === 'interval'">
                <p>Path: Faster Generation</p>
            
                <!-- Upgrade Available -->
                <ng-container *ngIf="gameData.rockGeneratorInterval > gameData.minIntervalLimit">
                    <p>
                        {{ gameData.rockGeneratorInterval }}s →
                        {{
                        (gameData.rockGeneratorInterval - gameData.intervalIncrement) < gameData.minIntervalLimit
                            ? gameData.minIntervalLimit
                            : gameData.rockGeneratorInterval - gameData.intervalIncrement
                        }}s
                    </p>
                    <p>Cost: {{ gameData.rockIntervalUpgradeCost }} papers</p>
                    <button 
                        (click)="upgradeInterval('rock')" 
                        [disabled]="gameData.papers < gameData.rockIntervalUpgradeCost">
                        Upgrade
                    </button>
                </ng-container>
            
                <!-- Limit Reached -->
                <ng-container *ngIf="gameData.rockGeneratorInterval <= gameData.minIntervalLimit">
                    <p>Limit Reached</p>
                    <button disabled>Upgrade</button>
                </ng-container>
            </ng-container>
          
            <!-- Branch: Active -->
            <ng-container *ngIf="gameData.rockBranchChosen === 'active'">
              <p>Path: Active Rocks</p>
              <p>Collectible rocks fall on the game screen</p>
              <p>Cost: {{ gameData.rockActiveUpgradeCost }} papers</p>
              <button 
                  (click)="upgradeActiveGeneration('rock')" 
                  [disabled]="gameData.papers < gameData.rockActiveUpgradeCost">
                  Upgrade
              </button>
            </ng-container>
          </div>
          
        <!-- Paper Generator -->
        <div class="shop-item">
            <p>Paper Generator</p>
            <p>Generates {{ gameData.paperGenerationAmount }} paper{{ gameData.paperGenerationAmount == 1 ? '' : 's' }} every {{ gameData.paperGeneratorInterval }} seconds</p>
        
            <!-- Not Purchased -->
            <ng-container *ngIf="!gameData.paperGeneratorActive">
                <p>Cost: {{ gameData.generatorCost }} points</p>
                <button 
                    (click)="purchaseGenerator('paper')" 
                    [disabled]="(gameData.points < gameData.generatorCost) || (!gameData.paperSniperActive)">
                    Buy
                </button>
            </ng-container>
        
            <!-- Active and Not Maxed -->
            <ng-container *ngIf="gameData.paperGeneratorActive && gameData.paperGenerationAmount < gameData.maxGenerationAmount">
                <p>{{ gameData.paperGenerationAmount }} →
                    {{ gameData.paperGenerationAmount + (gameData.firstPaperGenUpgrade ? gameData.generationIncrement - 1 : gameData.generationIncrement) }}
                </p>
                <p>Cost: {{ gameData.paperGenerationUpgradeCost }} points</p>
                <button 
                    (click)="purchaseGenerationUpgrade('paper')"
                    [disabled]="(gameData.points < gameData.paperGenerationUpgradeCost)">
                    Upgrade
                </button>
            </ng-container>
        
            <!-- Maxed and No Branch Picked -->
            <ng-container *ngIf="gameData.paperGeneratorActive && gameData.paperGenerationAmount >= gameData.maxGenerationAmount && (gameData.paperBranchChosen === 'none')">
                <p>Generator Maxed. Choose your upgrade path:</p>
                <button (click)="chooseBranch('paper', 'interval')">Improve Generation Speed</button>
                <button (click)="chooseBranch('paper', 'active')">Collect Active Falling Papers</button>
            </ng-container>
        
            <!-- Branch: Interval -->
            <ng-container *ngIf="gameData.paperBranchChosen === 'interval'">
            <p>Path: Faster Generation</p>
        
            <!-- Upgrade Available -->
            <ng-container *ngIf="gameData.paperGeneratorInterval > gameData.minIntervalLimit">
                <p>
                {{ gameData.paperGeneratorInterval }}s →
                {{
                    (gameData.paperGeneratorInterval - gameData.intervalIncrement) < gameData.minIntervalLimit
                    ? gameData.minIntervalLimit
                    : gameData.paperGeneratorInterval - gameData.intervalIncrement
                }}s
                </p>
                <p>Cost: {{ gameData.paperIntervalUpgradeCost }} scissors</p>
                <button 
                    (click)="upgradeInterval('paper')" 
                    [disabled]="gameData.scissors < gameData.paperIntervalUpgradeCost">
                    Upgrade
                </button>
            </ng-container>
        
                <!-- Limit Reached -->
                <ng-container *ngIf="gameData.paperGeneratorInterval <= gameData.minIntervalLimit">
                    <p>Limit Reached</p>
                    <button disabled>Upgrade</button>
                </ng-container>
            </ng-container>
        
            <!-- Branch: Active -->
            <ng-container *ngIf="gameData.paperBranchChosen === 'active'">
                <p>Path: Active Papers</p>
                <p>Collectible papers fall on the game screen</p>
                <p>Cost: {{ gameData.paperActiveUpgradeCost }} scissors</p>
                <button 
                    (click)="upgradeActiveGeneration('paper')" 
                    [disabled]="gameData.scissors < gameData.paperActiveUpgradeCost">
                    Upgrade
                </button>
            </ng-container>
        </div>
  

        <!-- Scissor Generator -->
        <div class="shop-item">
            <p>Scissor Generator</p>
            <p>Generates {{ gameData.scissorGenerationAmount }} scissor{{ gameData.scissorGenerationAmount == 1 ? '' : 's' }} every {{ gameData.scissorGeneratorInterval }} seconds</p>
        
            <!-- Not Purchased -->
            <ng-container *ngIf="!gameData.scissorGeneratorActive">
            <p>Cost: {{ gameData.generatorCost }} points</p>
            <button 
                (click)="purchaseGenerator('scissor')" 
                [disabled]="(gameData.points < gameData.generatorCost) || (!gameData.scissorSniperActive)">
                Buy
            </button>
            </ng-container>
        
            <!-- Active and Not Maxed -->
            <ng-container *ngIf="gameData.scissorGeneratorActive && gameData.scissorGenerationAmount < gameData.maxGenerationAmount">
            <p>{{ gameData.scissorGenerationAmount }} →
                {{ gameData.scissorGenerationAmount + (gameData.firstScissorGenUpgrade ? gameData.generationIncrement - 1 : gameData.generationIncrement) }}
            </p>
            <p>Cost: {{ gameData.scissorGenerationUpgradeCost }} points</p>
            <button 
                (click)="purchaseGenerationUpgrade('scissor')"
                [disabled]="(gameData.points < gameData.scissorGenerationUpgradeCost)">
                Upgrade
            </button>
            </ng-container>
        
            <!-- Maxed and No Branch Picked -->
            <ng-container *ngIf="gameData.scissorGeneratorActive && gameData.scissorGenerationAmount >= gameData.maxGenerationAmount && (gameData.scissorBranchChosen === 'none')">
                <p>Generator Maxed. Choose your upgrade path:</p>
                <button (click)="chooseBranch('scissor', 'interval')">Improve Generation Speed</button>
                <button (click)="chooseBranch('scissor', 'active')">Collect Active Falling Scissors</button>
            </ng-container>
        
            <!-- Branch: Interval -->
            <ng-container *ngIf="gameData.scissorBranchChosen === 'interval'">
            <p>Path: Faster Generation</p>
        
            <!-- Upgrade Available -->
            <ng-container *ngIf="gameData.scissorGeneratorInterval > gameData.minIntervalLimit">
                <p>
                {{ gameData.scissorGeneratorInterval }}s →
                {{
                    (gameData.scissorGeneratorInterval - gameData.intervalIncrement) < gameData.minIntervalLimit
                    ? gameData.minIntervalLimit
                    : gameData.scissorGeneratorInterval - gameData.intervalIncrement
                }}s
                </p>
                <p>Cost: {{ gameData.scissorIntervalUpgradeCost }} rocks</p>
                <button 
                    (click)="upgradeInterval('scissor')" 
                    [disabled]="gameData.rocks < gameData.scissorIntervalUpgradeCost">
                    Upgrade
                </button>
            </ng-container>
        
                <!-- Limit Reached -->
                <ng-container *ngIf="gameData.scissorGeneratorInterval <= gameData.minIntervalLimit">
                    <p>Limit Reached</p>
                    <button disabled>Upgrade</button>
                </ng-container>
            </ng-container>
        
            <!-- Branch: Active -->
            <ng-container *ngIf="gameData.scissorBranchChosen === 'active'">
                <p>Path: Active Scissors</p>
                <p>Collectible scissors fall on the game screen</p>
                <p>Cost: {{ gameData.scissorActiveUpgradeCost }} rocks</p>
                <button 
                    (click)="upgradeActiveGeneration('scissor')" 
                    [disabled]="gameData.rocks < gameData.scissorActiveUpgradeCost">
                    Upgrade
                </button>
            </ng-container>
        </div>
  
    <!-- Fuel Purchase -->
    <div class="fuel-container">
        <div class="fuel">
            <p>Cost: {{ gameData.fuelCost }} points</p>
            <div>
                <button (click)="purchaseFuel('rock')" [disabled]="(gameData.points < gameData.fuelCost) || (!gameData.rockSniperActive)">+{{gameData.fuelAmount}} Rocks</button>
                <button (click)="purchaseFuel('paper')" [disabled]="(gameData.points < gameData.fuelCost) || (!gameData.paperSniperActive)">+{{gameData.fuelAmount}} Papers</button>
                <button (click)="purchaseFuel('scissor')" [disabled]="(gameData.points < gameData.fuelCost) || (!gameData.scissorSniperActive)">+{{gameData.fuelAmount}} Scissors</button>
            </div>
        </div>
    </div>

    <!-- Navigation Buttons -->
    <div class="button-group">
        <button routerLink="/shop" class="next-button"><</button>
        <button routerLink="/" class="back-button">Back to Game</button>
        <button routerLink="/shop3" class="next-button">></button>
    </div>
</div>
